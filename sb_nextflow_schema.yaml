app_content:
  code_package: 6491d6caee36ac0be26968c2
  entrypoint: main.nf
class: nextflow
cwlVersion: None
doc: "**DESeq2** performs differential gene expression analysis by use of negative\
  \ binomial generalized linear models. It analyzes estimated read counts from several\
  \ samples, each belonging to one of two or more conditions under study, searching\
  \ for systematic changes between conditions, as compared to within-condition variability.\n\
  \n**DESeq2** offers two kinds of hypothesis tests: the Wald test, where we use the\
  \ estimated standard error of a log2 fold change to test if it is equal to zero,\
  \ and the likelihood ratio test (LRT). **Deseq2** wrapped for this purpose offers\
  \ the Wald test.\n\n*A list of **all inputs and parameters** with corresponding\
  \ descriptions can be found at the bottom of this page.*\n\n***Please note that\
  \ any cloud infrastructure costs resulting from app and pipeline executions, including\
  \ the use of public apps, are the sole responsibility of you as a user. To avoid\
  \ excessive costs, please read the app description carefully and set the app parameters\
  \ and execution settings accordingly.***\n\n### Common Use Cases\n\nThis tool takes\
  \ the **Counts** file generated by **tximport** tool and executes differential expression\
  \ analysis according to the information provided in **Samplesheet** and **Contrasts**\
  \ files. \n\nThis tool requires the following inputs:\n\n- **Counts** - a TSV format\
  \ expression matrix as output from the **tximport** tool. This file contains raw\
  \ transcript or gene counts for every sample that will be analysed.\n- **Samplesheet**\
  \ - a CSV or TSV file, which is a sample sheet with sample metadata. This file can\
  \ be generated by the **SBG Create Samplesheet from Metadata** tool or provided\
  \ manually. \n- **Contrasts** - a CSV, TSV file, which specifies the following features:\
  \ \n   * **variable** - the column in the **Samplesheet** file which will be used\
  \ for two condition comparison;\n   * **reference** - the condition in the **variable**\
  \ column which is considered as reference; \n   * **target** - the condition in\
  \ the **variable** column which is considered as target;\n   * **blocking** -  a\
  \ column in the **Samplesheet** file that can be a source of undesired variation\
  \ in the dependent variable.\n\n\nInput parameters and files that are not required\
  \ but should be mentioned are as follows:\n\n- **Control genes file** - a TXT file\
  \ that lists control genes, one per line.\n- **Gene column name** - column in **Counts**\
  \ file which corresponds to gene or transcript names.\n- **Sample ID column name**\
  \ - column in **Samplesheet** file which corresponds to sample IDs. \n- **VS method**\
  \ - type of transformation which **Deseq2** will use.\n\nThe outputs of **Deseq2**\
  \ are stored in the **Output files directory** and these are as follows:\n\n- **Results**\
  \ - a TSV-format table of differential expression information as the output of **Deseq2**.\n\
  - **Dispersion plot** - a PNG file which represents **DESeq2** dispersion plot.\n\
  - **Rdata** - a RDS file which represents serialised **DESeq2** object.\n- **Sizefactors**\
  \ - a TSV file that represents size factors.\n- **Normalized counts** - a TSV-format\
  \ counts matrix, normalised to size factors.\n- **Variance stabilised counts** -\
  \ a TSV-format counts matrix, normalised to size factors, with variance stabilisation\
  \ applied.\n- **Versions** - a YML file containing software versions.\n\nThere is\
  \ also **Work directory** output which is the default directory of the nextflow\
  \ executor. To learn more about the work directory visit [nf-core troubleshooting\
  \ page](https://nf-co.re/usage/troubleshooting).\n \n### Changes Introduced by Seven\
  \ Bridges\n\n- To adapt this module to our platform environment the `nextflow.config`\
  \ and `main.nf` files are modified and the `params.config` file is added into the\
  \ directory which was used to wrap the **Deseq2** tool. \n\n###Common Issues and\
  \ Important Notes\n\n- This is the **Nextflow** language implementation of **nf/core\
  \ deseq2_differential** module. To see more about the **Nextflow** feature on our\
  \ platform visit [Knowledge center](https://docs.sevenbridges.com/docs/bring-nextflow-apps-to-the-platform).\n\
  - If a large number of samples ( > 50) are considered in the **Samplesheet** file\
  \ `rlog` transformation is strongly discouraged as it will take a long time to execute.\n\
  - When using `vst` transformation pay attention to the **Number of genes to subset**\
  \ parameter. The number of genes to subset is often larger than the number of provided\
  \ genes and in this case, the tool will fail. \n- When specifying multiple blocking\
  \ variables in  **blocking** column of **Contrasts** file, separate values with\
  \ semicolon (;). E.g., `sample_number`;`read_length`.\n- When specifying **Exclude\
  \ sample values** parameter, separate values with semicolon (;). E.g., `sample1`;`sample2`.\n\
  - All other issues and important notes are listed in [Deseq2 vignete](http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html).\n\
  \n### Limitations\n\n- Tool is only tested with nf-core/test-datasets.\n- `LRT`test\
  \ can't be performed with this tool as the`Deseq2.R` script is specifically wrapped\
  \ for pairwise comparisons."
inputs:
- default: output_gen
  description: The name of the output directory.
  doc: The name of the output directory.
  id: outdir
  inputBinding:
    prefix: --outdir
  label: Output directory name
  sbg:toolDefaultValue: output_gen
  type:
  - string?
  - 'null'
- description: Specify if any supplied control genes should just be stripped to prevent
    bias in conventional normalisation (default), or used to generate the size factors.
  doc: Specify if any supplied control genes should just be stripped to prevent bias
    in conventional normalisation (default), or used to generate the size factors.
  id: sizefactors_from_controls
  inputBinding:
    prefix: --sizefactors_from_controls
  label: Sizefactors from controls
  sbg:toolDefaultValue: false
  type:
  - boolean?
  - 'null'
- description: Column in Counts file which corresponds to gene or transcript names.
  doc: Column in Counts file which corresponds to gene or transcript names.
  id: gene_id_col
  inputBinding:
    prefix: --gene_id_col
  label: Gene column name
  sbg:toolDefaultValue: gene_id
  type:
  - string?
  - 'null'
- description: Column in Samplesheet file which corresponds to sample IDs.
  doc: Column in Samplesheet file which corresponds to sample IDs.
  id: sample_id_col
  inputBinding:
    prefix: --sample_id_col
  label: Sample ID column name
  sbg:toolDefaultValue: experiment_accession
  type:
  - string?
  - 'null'
- description: In differential analysis (DEseq2 or Limma), subset to the contrast
    samples before modelling variance.
  doc: In differential analysis (DEseq2 or Limma), subset to the contrast samples
    before modelling variance.
  id: subset_to_contrast_samples
  inputBinding:
    prefix: --subset_to_contrast_samples
  label: Subset to contrast samples
  sbg:toolDefaultValue: false
  type:
  - boolean?
  - 'null'
- description: Column in Samplesheet file specified to subset (exclude) samples.
  doc: Column in Samplesheet file specified to subset samples.
  id: exclude_samples_col
  inputBinding:
    prefix: --exclude_samples_col
  label: Exclude sample columns
  sbg:toolDefaultValue: null
  type:
  - string?
  - 'null'
- description: Values in the specified Samplesheet column which will be excluded.
    Every value is separated by semicolon(';').
  doc: Values in the specified Samplesheet column which will be excluded. Every value
    is separated by semicolon(';').
  id: exclude_samples_values
  inputBinding:
    prefix: --exclude_samples_values
  label: Exclude sample values
  sbg:toolDefaultValue: null
  type:
  - string?
  - 'null'
- description: Either "parametric", "local", or "mean", for the type of fitting of
    dispersions to the mean intensity.
  doc: Either "parametric", "local", or "mean" for the type of fitting of dispersions
    to the mean intensity.
  id: fit_type
  inputBinding:
    prefix: --fit_type
  label: Fitting type of dispersion
  sbg:toolDefaultValue: parametric
  type:
  - 'null'
  - name: fit_type
    symbols:
    - parametric
    - local
    - mean
    type: enum?
- description: Either "ratio", "poscounts", or "iterate" for the type of size factor
    estimation.
  doc: Either "ratio", "poscounts", or "iterate" for the type of size factor estimation.
  id: sf_type
  inputBinding:
    prefix: --sf_type
  label: Type of size factor estimation
  sbg:toolDefaultValue: ratio
  type:
  - 'null'
  - name: sf_type
    symbols:
    - ratio
    - poscounts
    - iterate
    type: enum?
- description: The minimum number of replicates required in order to use replaceOutliers
    on a sample. If there are samples with so many replicates, the model will be refit
    after these replacing outliers, flagged by Cook's distance. Set to Inf in order
    to never replace outliers.
  doc: The minimum number of replicates required in order to use replaceOutliers on
    a sample. If there are samples with so many replicates, the model will be refit
    after these replacing outliers, flagged by Cook's distance. Set to Inf in order
    to never replace outliers.
  id: min_replicates_for_replace
  inputBinding:
    prefix: --min_replicates_for_replace
  label: Minimum replicates for replace
  sbg:toolDefaultValue: 7
  type:
  - int?
  - 'null'
- description: Logical, passed to nbinomWaldTest, default is FALSE, where Wald statistics
    are assumed to follow a standard Normal.
  doc: Logical, passed to nbinomWaldTest, default is FALSE, where Wald statistics
    are assumed to follow a standard Normal.
  id: use_t
  inputBinding:
    prefix: --use_t
  label: Use nbinomWaldTest
  sbg:toolDefaultValue: false
  type:
  - boolean?
  - 'null'
- description: "A non-negative value which specifies a log2 fold change threshold.\
    \ This can be used with any shrinkage type. It will produce new p-values or s-values\
    \ testing whether the LFC is greater in absolute value than the threshold. The\
    \ s-values returned in combination with apeglm or ashr provide the probability\
    \ of FSOS events, \"false sign or small\", among the tests with equal or smaller\
    \ s-value than a given gene\u2019s s-value, where \"small\" is specified by lfcThreshold."
  doc: "A non-negative value which specifies a log2 fold change threshold. This can\
    \ be used with any shrinkage type. It will produce new p-values or s-values testing\
    \ whether the LFC is greater in absolute value than the threshold. The s-values\
    \ returned in combination with apeglm or ashr provide the probability of FSOS\
    \ events, \"false sign or small\", among the tests with equal or smaller s-value\
    \ than a given gene\u2019s s-value, where \"small\" is specified by lfcThreshold."
  id: lfc_threshold
  inputBinding:
    prefix: --lfc_threshold
  label: log2 fold change threshold
  sbg:toolDefaultValue: 0
  type:
  - float?
  - 'null'
- description: Character which specifies the alternative hypothesis, i.e. those values
    of log2 fold change which the user is interested in finding. The complement of
    this set of values is the null hypothesis which will be tested. If the log2 fold
    change specified by 'name' or by contrast' is written as beta , then the possible
    values for 'altHypothesis' represent the following alternate hypotheses; 1) greaterAbs;
    |beta| > lfcThreshold , and p-values are two-tailed 2) lessAbs; |beta| < lfcThreshold
    , p values are the maximum of the upper and lower tests. The Wald statistic given
    is positive, an SE-scaled distance from the closest boundary 3) greater; beta
    > lfcThreshold 4) less; beta < -lfcThreshold.
  doc: Character which specifies the alternative hypothesis, i.e. those values of
    log2 fold change which the user is interested in finding. The complement of this
    set of values is the null hypothesis which will be tested. If the log2 fold change
    specified by 'name' or by contrast' is written as beta , then the possible values
    for 'altHypothesis' represent the following alternate hypotheses; 1) greaterAbs;
    |beta| > lfcThreshold , and p-values are two-tailed 2) lessAbs; |beta| < lfcThreshold
    , p values are the maximum of the upper and lower tests. The Wald statistic given
    is positive, an SE-scaled distance from the closest boundary 3) greater; beta
    > lfcThreshold 4) less; beta < -lfcThreshold.
  id: alt_hypothesis
  inputBinding:
    prefix: --alt_hypothesis
  label: Alternative hypothesis
  sbg:toolDefaultValue: greaterAbs
  type:
  - 'null'
  - name: alt_hypothesis
    symbols:
    - greaterAbs
    - lessAbs
    - greater
    - less
    type: enum?
- description: Whether independent filtering should be applied automatically.
  doc: Whether independent filtering should be applied automatically.
  id: independent_filtering
  inputBinding:
    prefix: --independent_filtering
  label: Independent filtering
  sbg:toolDefaultValue: true
  type:
  - boolean?
  - 'null'
- description: The method to use for adjusting p-values. Available methods are; "holm",
    "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr", "none".
  doc: Whether The method to use for adjusting p-values. Available methods are; "holm",
    "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr", "none".
  id: p_adjust_method
  inputBinding:
    prefix: --p_adjust_method
  label: P adjust method
  sbg:toolDefaultValue: BH
  type:
  - 'null'
  - name: p_adjust_method
    symbols:
    - holm
    - hochberg
    - hommel
    - bonferroni
    - BH
    - BY
    - fdr
    - none
    type: enum?
- description: The significance cutoff used for optimizing the independent filtering.
    If the adjusted p-value cutoff (FDR) will be a value other than 0.1, alpha should
    be set to that value.
  doc: Whether The significance cutoff used for optimizing the independent filtering.
    If the adjusted p-value cutoff (FDR) will be a value other than 0.1, alpha should
    be set to that value.
  id: alpha
  inputBinding:
    prefix: --alpha
  label: Alpha value
  sbg:toolDefaultValue: 0.1
  type:
  - float?
  - 'null'
- description: Lower bound on the estimated count for fitting gene-wise dispersion
    and for use with nbinomWaldTest and nbinomLRT.
  doc: Lower bound on the estimated count for fitting gene-wise dispersion and for
    use with nbinomWaldTest and nbinomLRT.
  id: minmu
  inputBinding:
    prefix: --minmu
  label: Lower bound estimated count
  sbg:toolDefaultValue: 0.5
  type:
  - float?
  - 'null'
- description: Estimate shrunken LFC (posterior estimates) using ashr package.
  doc: Estimate shrunken LFC (posterior estimates) using ashr pakgage.
  id: shrink_lfc
  inputBinding:
    prefix: --shrink_lfc
  label: Estimated shrunken LFC
  sbg:toolDefaultValue: true
  type:
  - boolean?
  - 'null'
- description: Number of cores to use with DESeq().
  doc: Number of cores to use with DESeq().
  id: cores
  inputBinding:
    prefix: --cores
  label: Number of cores
  sbg:toolDefaultValue: 1
  type:
  - int?
  - 'null'
- description: Type of transformation that will be used on Counts data. 'rlog' or
    'vst'.
  doc: Type of transformation that will be used on Counts data. 'rlog' or 'vst'.
  id: vs_method
  inputBinding:
    prefix: --vs_method
  label: VS method
  sbg:toolDefaultValue: vst
  type:
  - 'null'
  - name: vs_method
    symbols:
    - vst
    - rlog
    type: enum?
- description: Whether to blind the transformation to the experimental design. blind=TRUE
    should be used for comparing samples in a manner unbiased by prior information
    on samples, for example to perform sample QA (quality assurance). blind=FALSE
    should be used for transforming data for downstream analysis, where the full use
    of the design information should be made. blind=FALSE will skip re-estimation
    of the dispersion trend, if this has already been calculated. If many of genes
    have large differences in counts due to the experimental design, it is important
    to set blind=FALSE for downstream analysis.
  doc: Whether to blind the transformation to the experimental design. blind=TRUE
    should be used for comparing samples in a manner unbiased by prior information
    on samples, for example to perform sample QA (quality assurance). blind=FALSE
    should be used for transforming data for downstream analysis, where the full use
    of the design information should be made. blind=FALSE will skip re-estimation
    of the dispersion trend, if this has already been calculated. If many of genes
    have large differences in counts due to the experimental design, it is important
    to set blind=FALSE for downstream analysis.
  id: vs_blind
  inputBinding:
    prefix: --vs_blind
  label: Blind transformation to experimental design
  sbg:toolDefaultValue: true
  type:
  - boolean?
  - 'null'
- description: The number of genes to subset to when using vst transformation.
  doc: The number of genes to subset to when using vst transformation.
  id: vst_nsub
  inputBinding:
    prefix: --vst_nsub
  label: Number of genes to subset
  sbg:toolDefaultValue: 1000
  type:
  - int?
  - 'null'
- description: CSV or TSV format sample sheet with sample metadata.
  doc: CSV or TSV format sample sheet with sample metadata.
  id: in_samplesheet
  inputBinding:
    prefix: --samplesheet
  label: Samplesheet
  sbg:fileTypes: CSV, TSV
  type: File
- description: Raw TSV or CSV format expression matrix as output from the nf-core
    RNA-seq workflow.
  doc: Raw TSV or CSV format expression matrix as output from the nf-core RNA-seq
    workflow.
  id: in_counts
  inputBinding:
    prefix: --counts
  label: Counts
  sbg:fileTypes: CSV, TSV
  type: File
- description: Text file listing control genes, one per line.
  doc: Text file listing control genes, one per line.
  id: in_control_genes
  inputBinding:
    prefix: --control_genes_file
  label: Control genes file
  sbg:fileTypes: TXT
  type: File?
- description: Text file which specifies variable of interest.
  doc: Text file which specifies variable of interest.
  id: in_contrast
  inputBinding:
    prefix: --contrast_file
  label: Contrast file
  sbg:fileTypes: CSV
  type: File
outputs:
- description: Output work directory.
  doc: Output work directory.
  id: nf_workdir
  label: Work directory
  outputBinding:
    glob: work
  type: Directory
- description: Output files directory.
  doc: Output files directory.
  id: output_results
  label: Output files directory
  outputBinding:
    glob: $(inputs.outdir)
  type: Directory
requirements:
- class: InlineJavascriptRequirement
- class: InitialWorkDirRequirement
  listing:
  - $(inputs.in_samplesheet)
  - $(inputs.in_counts)
  - $(inputs.in_control_genes)
  - $(inputs.in_contrast)
